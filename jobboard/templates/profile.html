{% extends 'base.html' %}
{% block title %}Профиль — {{ profile['username'] }}{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-4">
    <div class="card bg-glass shadow-sm p-3 text-center">
      <img src="{{ profile['avatar'] or url_for('static', filename='avatar-default.svg') }}" alt="avatar" width="120" class="rounded-circle mb-3">
      <h4>{{ profile['username'] }}</h4>
      <p class="text-muted small">{{ profile['email'] or '' }}</p>
      <p>{{ profile['about'] or 'Пока нет описания.' }}</p>
      {% if user and user['id'] == profile['id'] %}
      <button class="btn btn-outline-primary" data-bs-toggle="collapse" data-bs-target="#editProfile">Редактировать</button>
      {% endif %}
    </div>
    <div class="mt-3">
      <h6>Отклики</h6>
      <ul class="list-group">
        {% for r in responses %}
          <li class="list-group-item">
            <a href="{{ url_for('job_detail', job_id=r['job_id']) }}">{{ r['job_title'] or 'Вакансия' }}</a>
            <div class="small text-muted">{{ r['created'] }}</div>
          </li>
        {% else %}
          <li class="list-group-item text-muted">Нет откликов</li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="col-md-8">
    {% if user and user['id']==profile['id'] %}
    <div class="collapse" id="editProfile">
      <div class="card bg-glass p-3 mb-3">
        <form method="post" action="{{ url_for('profile', username=profile['username']) }}">
          <div class="mb-3">
            <label class="form-label">О себе</label>
            <textarea name="about" class="form-control" rows="3">{{ profile['about'] }}</textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Аватар (URL)</label>
            <input name="avatar" class="form-control" value="{{ profile['avatar'] or '' }}">
          </div>
          <button class="btn btn-primary">Сохранить</button>
        </form>
      </div>
    </div>
    {% endif %}
    <div class="card bg-glass p-3">
      <h5>Публикации</h5>
      <div class="row g-3">
        {% for job in jobs %}
          <div class="col-12">
            <div class="border p-2 rounded">
              <a href="{{ url_for('job_detail', job_id=job['id']) }}">{{ job['title'] }}</a>
              <div class="small text-muted">{{ job['created'] }}</div>
            </div>
          </div>
        {% else %}
          <div class="col-12 text-muted">Нет публикаций</div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}